# Sales Analytics Dashboard

## Overview

The **Sales Analytics Dashboard** is a comprehensive solution for generating, processing, and analyzing sales data. It leverages **Apache Airflow** for workflow orchestration, **Spark** for analytics with Master Data Management, and a web-based dashboard for visualization.

---

## Features

- **Data Generation**: Synthetic sales data generation using Airflow DAGs.
- **Master Data Management**: Data standardization, deduplication, and quality metrics.
- **Data Processing**: Loading data into MySQL and performing analytics with Spark.
- **Dashboard**: Interactive web-based dashboard for visualizing sales trends and insights.

---

## Project Structure

### Airflow Setup
- **`airflow-docker/`**: Contains the Airflow setup and DAGs for data generation, processing, and analytics.
  - **`docker-compose.yml`**: Configuration for running Airflow in Docker.
  - **`dags/`**: Airflow DAGs for generating synthetic data, loading data to MySQL, MDM processing, and running Spark analytics.
  - **`mysql/`**: Database initialization files.
    - **`init.sql`**: Schema and table creation script.
  - **`config/`**: Configuration files for Airflow.

### Dashboard
- **`dashboard/`**: Web application for visualizing sales data.
  - **`app.py`**: Main application file for the dashboard.
  - **`templates/`**: HTML templates for the dashboard.
  - **`static/`**: Static files like JavaScript for charts.

### Other Components
- **`drivers/`**: Contains the MySQL connector jar file.
- **`logs/`**: Logs generated by Airflow DAG runs.
- **`scripts/`**: Additional Python scripts for data processing.
  - **`process_data.py`**: Enhanced Spark analytics with master data integration.
  - **`mdm_processor.py`**: Master Data Management processing logic.

---

## Database Schema

The platform creates the following tables:

| Table Name            | Description                                      |
|-----------------------|--------------------------------------------------|
| **transactions**      | Raw sales data with source file tracking         |
| **revenue_per_product** | Product performance analytics                   |
| **monthly_revenue**   | Time-series revenue analysis                     |
| **master_customers**  | Golden customer records with standardization     |
| **master_products**   | Golden product records with deduplication        |
| **data_quality_summary** | Data profiling and quality metrics             |

---

## Prerequisites

- Docker
- Python 3.7+
- Apache Airflow
- Apache Spark
- MySQL

---

## Setup

### Clone the repository:
```bash
git clone https://github.com/karol-wojak/sales-analytics-dashboard.git
cd sales-analytics-dashboard
```

### Initialize the database and start the Airflow environment:
```bash
cd airflow-docker
docker-compose up -d

# Wait for services to start
sleep 60
```

### Verify database initialization:
```bash
# Check that all tables were created
docker exec airflow-mysql mysql -u root -proot -e "USE sales_db; SHOW TABLES;"
```

### Configure Airflow MySQL connection:
1. Access Airflow UI at **http://localhost:8080** (username: `admin`, password: `admin`).
2. Go to **Admin → Connections → Add new connection**.
3. Set the following:
   - **Connection Id**: `mysql_default`
   - **Connection Type**: `MySQL`
   - **Host**: `airflow-mysql`
   - **Schema**: `sales_db`
   - **Login**: `root`
   - **Password**: `root`
   - **Port**: `3306`
4. Click **Save**.

### Install dependencies for the dashboard:
```bash
cd dashboard
pip install -r requirements.txt
```

---

## Usage

- Access the **Airflow UI** at [http://localhost:8080](http://localhost:8080) to manage DAGs.
- Open the **dashboard** at [http://localhost:5000](http://localhost:5000) to view sales analytics.

---

## Pipeline Flow

1. **Data Generation**: Creates synthetic sales transactions.
2. **Data Loading**: Loads data into MySQL with duplicate handling.
3. **Master Data Management**: Standardizes and deduplicates customer/product data.
4. **Analytics Processing**: Calculates metrics using clean master data.
5. **Visualization**: Interactive dashboard with improved data quality.

---

## License

This project is licensed under the **MIT License**.

